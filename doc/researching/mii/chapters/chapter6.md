# Módulo V. Comparación

Se muestra la comparación de diseños ECDSA/KCDSA descritos en un Lenguaje de Descripción de Hardware.

## Comparación de Firmas Criptográficas

.. ....... ........ ........ ....... .. ........... ...... .... .. ...... ..... .. ..... .... ........ ... ...... . ... .... .. ......... ........... .... .... ........ .. .... . ..... ....... .... ... ........ .... ............ .. ... ... ....... .. ...... .... ... .... ....... .. ..... ... .... ....... ... ....... ......... ..... .......... ....... ..... ....... ... ....... ... ....... ..... ..... .... . ........ .. ... ..... ......... .. ........ ..... ....... .......... .......... ... ........ .. ... ..... .. ........ ..... .......... .... ... ...... .. .....

### Comparación de Modelos Matemáticos

.. ....... ........ ........ ....... .. ........... ...... .... .. ...... ..... .. ..... .... ........ ... ...... . ... .... .. ......... ........... .... .... ........ .. .... . ..... ....... .... ... ........ .... ............ .. ... ... ....... .. ...... .... ... .... ....... .. ..... ... .... ....... ... ....... ......... ..... .......... ....... ..... ....... ... ....... ... ....... ..... ..... .... . ........ .. ... ..... ......... .. ........ ..... ....... .......... .......... ... ........ .. ... ..... .. ........ ..... .......... .... ... ...... .. .....

**Proceso de firma ECDSA**

* Seleccione aleatoriamente un número k en el intervalo [1, n-1].
* Calcule kP = (x~1~, y~1~).
* Calcule r = x~1~ mod n. Si r = 0, regrese al primer paso. En este paso x~1~ es tratado como un número entero.
* Calcule e = H(m). H(m) es el hash del mensaje m a firmar, calculado con el algoritmo SHA-256/SHA-512.
* Calcule s = k^-1^(e + dr) mod n. Si s = 0, regrese al primer paso.
* La firma del mensaje m son los números r y s.

.. ....... ........ ........ ....... .. ........... ...... .... .. ...... ..... .. ..... .... ........ ... ...... . ... .... .. ......... ........... .... .... ........ .. .... . ..... ....... .... ... ........ .... ............ .. ... ... ....... .. ...... .... ... .... ....... .. ..... ... .... ....... ... ....... ......... ..... .......... ....... ..... ....... ... ....... ... ....... ..... ..... .... . ........ .. ... ..... ......... .. ........ ..... ....... .......... .......... ... ........ .. ... ..... .. ........ ..... .......... .... ... ...... .. .....

**Proceso de firma KCDSA**

* Seleccione aleatoriamente un número k en el intervalo [1, n-1].
* Calcule kP = (x~1~, y~1~).
* Calcule r = H(x~1~). H(x~1~) es el hash de la coordenada x~1~, calculado con el algoritmo SHA-256/SHA-512.
* Calcule e = H(m). H(m) es el hash del mensaje m a firmar, calculado con el algoritmo SHA-256/SHA-512.
* Calcule w = r xor e. En este paso w es tratado como un número entero.
* Si w >= n, calcule w = w - n.
* Calcule s = d(k - w) mod n. Si s = 0, regrese al primer paso.
* La firma del mensaje m son los números r y s.

.. ....... ........ ........ ....... .. ........... ...... .... .. ...... ..... .. ..... .... ........ ... ...... . ... .... .. ......... ........... .... .... ........ .. .... . ..... ....... .... ... ........ .... ............ .. ... ... ....... .. ...... .... ... .... ....... .. ..... ... .... ....... ... ....... ......... ..... .......... ....... ..... ....... ... ....... ... ....... ..... ..... .... . ........ .. ... ..... ......... .. ........ ..... ....... .......... .......... ... ........ .. ... ..... .. ........ ..... .......... .... ... ...... .. .....

| Proceso de firma ECDSA                                            | Proceso de firma KCDSA                                         |
|:------------------------------------------------------------------|:---------------------------------------------------------------|
| Seleccione aleatoriamente un número k en el intervalo [1, n-1]    | Seleccione aleatoriamente un número k en el intervalo [1, n-1] |
| Calcule kP = (x~1~, y~1~)                                         | Calcule kP = (x~1~, y~1~)                                      |
| Calcule r = x~1~ mod n. Si r = 0, regrese al primer paso          | Calcule r = H(x~1~)                                            |
| Calcule e = H(m)                                                  | Calcule e = H(m)                                               |
| ---                                                               | Calcule w = r xor e                                            |
|                                                                   | Si w >= n, calcule w = w - n                                   |
| Calcule s = k^-1^(e + dr) mod n. Si s = 0, regrese al primer paso | Calcule s = d(k - w) mod n. Si s = 0, regrese al primer paso   |
| La firma del mensaje m son los números r y s                      | La firma del mensaje m son los números r y s                   |

: Sign Comparation

.. ....... ........ ........ ....... .. ........... ...... .... .. ...... ..... .. ..... .... ........ ... ...... . ... .... .. ......... ........... .... .... ........ .. .... . ..... ....... .... ... ........ .... ............ .. ... ... ....... .. ...... .... ... .... ....... .. ..... ... .... ....... ... ....... ......... ..... .......... ....... ..... ....... ... ....... ... ....... ..... ..... .... . ........ .. ... ..... ......... .. ........ ..... ....... .......... .......... ... ........ .. ... ..... .. ........ ..... .......... .... ... ...... .. .....

### Comparación de Prototipos en Lenguaje de Programación

.. ....... ........ ........ ....... .. ........... ...... .... .. ...... ..... .. ..... .... ........ ... ...... . ... .... .. ......... ........... .... .... ........ .. .... . ..... ....... .... ... ........ .... ............ .. ... ... ....... .. ...... .... ... .... ....... .. ..... ... .... ....... ... ....... ......... ..... .......... ....... ..... ....... ... ....... ... ....... ..... ..... .... . ........ .. ... ..... ......... .. ........ ..... ....... .......... .......... ... ........ .. ... ..... .. ........ ..... .......... .... ... ...... .. .....

### Comparación de Diseños RTL

.. ....... ........ ........ ....... .. ........... ...... .... .. ...... ..... .. ..... .... ........ ... ...... . ... .... .. ......... ........... .... .... ........ .. .... . ..... ....... .... ... ........ .... ............ .. ... ... ....... .. ...... .... ... .... ....... .. ..... ... .... ....... ... ....... ......... ..... .......... ....... ..... ....... ... ....... ... ....... ..... ..... .... . ........ .. ... ..... ......... .. ........ ..... ....... .......... .......... ... ........ .. ... ..... .. ........ ..... .......... .... ... ...... .. .....

## Comparación Verificaciones Criptográficas

.. ....... ........ ........ ....... .. ........... ...... .... .. ...... ..... .. ..... .... ........ ... ...... . ... .... .. ......... ........... .... .... ........ .. .... . ..... ....... .... ... ........ .... ............ .. ... ... ....... .. ...... .... ... .... ....... .. ..... ... .... ....... ... ....... ......... ..... .......... ....... ..... ....... ... ....... ... ....... ..... ..... .... . ........ .. ... ..... ......... .. ........ ..... ....... .......... .......... ... ........ .. ... ..... .. ........ ..... .......... .... ... ...... .. .....

### Comparación de Modelos Matemáticos

.. ....... ........ ........ ....... .. ........... ...... .... .. ...... ..... .. ..... .... ........ ... ...... . ... .... .. ......... ........... .... .... ........ .. .... . ..... ....... .... ... ........ .... ............ .. ... ... ....... .. ...... .... ... .... ....... .. ..... ... .... ....... ... ....... ......... ..... .......... ....... ..... ....... ... ....... ... ....... ..... ..... .... . ........ .. ... ..... ......... .. ........ ..... ....... .......... .......... ... ........ .. ... ..... .. ........ ..... .......... .... ... ...... .. .....

**Proceso de verificación ECDSA**

* Verifique que r y s estén dentro del rango [1,n-1].
* Calcule e = H(m).
* Calcule w = s^-1^ mod n.
* Calcule u~1~ = e·w mod n.
* Calcule u~2~ = r·w mod n.
* Calcule u~1~P + u~2~Q = (x~0~, y~0~).
* Calcule v = x~0~ mod n.
* La firma verifica si y sólo si v = r.

.. ....... ........ ........ ....... .. ........... ...... .... .. ...... ..... .. ..... .... ........ ... ...... . ... .... .. ......... ........... .... .... ........ .. .... . ..... ....... .... ... ........ .... ............ .. ... ... ....... .. ...... .... ... .... ....... .. ..... ... .... ....... ... ....... ......... ..... .......... ....... ..... ....... ... ....... ... ....... ..... ..... .... . ........ .. ... ..... ......... .. ........ ..... ....... .......... .......... ... ........ .. ... ..... .. ........ ..... .......... .... ... ...... .. .....

**Proceso de verificación KCDSA**

* Verifique que r y s estén dentro del rango [1,n-1].
* Calcule e = H(m).
* Calcule w = r xor e.
* Si w >= n, calcule w = w - n.
* Calcule wP + sQ = (x~0~, y~0~).
* Calcule v = H(x~0~).
* La firma verifica si y sólo si v = r.

.. ....... ........ ........ ....... .. ........... ...... .... .. ...... ..... .. ..... .... ........ ... ...... . ... .... .. ......... ........... .... .... ........ .. .... . ..... ....... .... ... ........ .... ............ .. ... ... ....... .. ...... .... ... .... ....... .. ..... ... .... ....... ... ....... ......... ..... .......... ....... ..... ....... ... ....... ... ....... ..... ..... .... . ........ .. ... ..... ......... .. ........ ..... ....... .......... .......... ... ........ .. ... ..... .. ........ ..... .......... .... ... ...... .. .....

| Proceso de verificación ECDSA                      | Proceso de verificación KCDSA                      |
|:---------------------------------------------------|:---------------------------------------------------|
| Verifique que r y s estén dentro del rango [1,n-1] | Verifique que r y s estén dentro del rango [1,n-1] |
| Calcule e = H(m)                                   | Calcule e = H(m)                                   |
| Calcule w = s^-1^ mod n                            | Calcule w = r xor e                                |
|                                                    | Si w >= n, calcule w = w - n                       |
| Calcule u~1~ = e·w mod n                           | ---                                                |
| Calcule u~2~ = r·w mod n                           |                                                    |
| Calcule u~1~P + u~2~Q = (x~0~, y~0~)               | Calcule wP + sQ = (x~0~, y~0~)                     |
| Calcule v = x~0~ mod n                             | Calcule v = H(x~0~)                                |
| La firma verifica si y sólo si v = r               | La firma verifica si y sólo si v = r               |

: Verify Comparation

.. ....... ........ ........ ....... .. ........... ...... .... .. ...... ..... .. ..... .... ........ ... ...... . ... .... .. ......... ........... .... .... ........ .. .... . ..... ....... .... ... ........ .... ............ .. ... ... ....... .. ...... .... ... .... ....... .. ..... ... .... ....... ... ....... ......... ..... .......... ....... ..... ....... ... ....... ... ....... ..... ..... .... . ........ .. ... ..... ......... .. ........ ..... ....... .......... .......... ... ........ .. ... ..... .. ........ ..... .......... .... ... ...... .. .....

### Comparación de Prototipos en Lenguaje de Programación

.. ....... ........ ........ ....... .. ........... ...... .... .. ...... ..... .. ..... .... ........ ... ...... . ... .... .. ......... ........... .... .... ........ .. .... . ..... ....... .... ... ........ .... ............ .. ... ... ....... .. ...... .... ... .... ....... .. ..... ... .... ....... ... ....... ......... ..... .......... ....... ..... ....... ... ....... ... ....... ..... ..... .... . ........ .. ... ..... ......... .. ........ ..... ....... .......... .......... ... ........ .. ... ..... .. ........ ..... .......... .... ... ...... .. .....

### Comparación de Diseños RTL

.. ....... ........ ........ ....... .. ........... ...... .... .. ...... ..... .. ..... .... ........ ... ...... . ... .... .. ......... ........... .... .... ........ .. .... . ..... ....... .... ... ........ .... ............ .. ... ... ....... .. ...... .... ... .... ....... .. ..... ... .... ....... ... ....... ......... ..... .......... ....... ..... ....... ... ....... ... ....... ..... ..... .... . ........ .. ... ..... ......... .. ........ ..... ....... .......... .......... ... ........ .. ... ..... .. ........ ..... .......... .... ... ...... .. .....
